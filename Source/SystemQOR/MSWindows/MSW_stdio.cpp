//MSW_stdio.cpp

// Copyright Querysoft Limited 2013
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
//
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#include "SystemQOR.h"

#if		( QOR_SYS_OS == QOR_SYS_MSW )

#include <errno.h>
#include <stdio.h>
#include <string.h>
#include "SystemQOR/MSWindows/MSW_stdio.h"
#include "WinQL/WinQL.h"
#include "WinQL/Application/ErrorSystem/WinQLError.h"
#include "WinQL/CodeServices/Text/WinQLStringServices.h"
#include "PosumQOR/PosumStream.h"

//--------------------------------------------------------------------------------
namespace nsWin32
{
	//__QOR_IMPLEMENT_OCLASS_LUID( Cstdio );

	//--------------------------------------------------------------------------------
	Cstdio::Cstdio()
	{
		_WINQ_FCONTEXT( "Cstdio::Cstdio" );
	}

	//--------------------------------------------------------------------------------
	Cstdio::~Cstdio()
	{
		_WINQ_FCONTEXT( "Cstdio::~Cstdio" );
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::_stdin( void )
	{
		_WINQ_FCONTEXT( "Cstdio::_stdin" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::_stdin()->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
    FILE* Cstdio::_stdout()
	{
		_WINQ_FCONTEXT( "Cstdio::_stdout" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::_stdout()->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
    FILE* Cstdio::_stderr()
	{
		_WINQ_FCONTEXT( "Cstdio::_stderr" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::_stderr()->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	void Cstdio::clearerr( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::clearerr" );
		__QOR_PROTECT
		{
			nsPosum::CStream Stream( stream );
			Stream.clearerr();
		}__QOR_ENDPROTECT
	}

	//--------------------------------------------------------------------------------
	errno_t Cstdio::clearerr_s( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::clearerr_s" );
		errno_t Result = 0;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream( stream ).clearerr_s();
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	char* Cstdio::ctermid( char* s )
	{
		_WINQ_FCONTEXT( "Cstdio::ctermid" );
		char* pResult = 0;
		__QOR_PROTECT
		{
			//TODO: pResult = nsPosum::CStream::ctermid(s);
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::dprintf( int fd, const char* format, va_list args )
	{
		_WINQ_FCONTEXT( "Cstdio::dprintf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(fd).vfprintf(format,args);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fclose( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fclose" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fclose();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::fdopen( int fd, const char* mode )
	{
		_WINQ_FCONTEXT( "Cstdio::fdopen" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::fdopen(fd, mode)->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::feof( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::feof" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).feof();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::ferror( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::ferror" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).ferror();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fflush( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fflush" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fflush();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fgetc( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fgetc" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fgetc();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fgetpos( FILE* stream, fpos_t* pos )
	{
		_WINQ_FCONTEXT( "Cstdio::fgetpos" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fgetpos(pos);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	char* Cstdio::fgets( char* s, int n, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fgets" );
		char* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream(stream).fgets(s, n);
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fileno( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fileno" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fileno();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	void Cstdio::flockfile( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::flockfile" );
		__QOR_PROTECT
		{
			nsPosum::CStream(stream).flockfile();
		}__QOR_ENDPROTECT
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::fmemopen( void* buf, size_t size, const char* szMode )
	{
		_WINQ_FCONTEXT( "Cstdio::fmemopen" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::fmemopen( buf, size, szMode )->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::fopen( const char* filename, const char* mode )
	{
		_WINQ_FCONTEXT( "Cstdio::fopen" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::fopen(filename, mode)->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	errno_t Cstdio::fopen_s( FILE** ppFile, const char* szFilename, const char* szMode )
	{
		_WINQ_FCONTEXT( "Cstdio::fopen_s" );
		errno_t Result = 0;
		__QOR_PROTECT
		{
			if( ppFile == 0 || szFilename == 0 || szMode == 0 )
			{
				Result = EINVAL;
			}
			else
			{
				*ppFile = nsPosum::CStream::fopen(szFilename, szMode)->GetFILE();
			}
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fprintf( FILE* stream, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::fprintf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream( stream ).vfprintf( format, vargs );
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fprintf_s( FILE* stream, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::fprintf_s" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).vfprintf(format, vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fputc( int c, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fputc" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fputc(c);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	//fputs
	int Cstdio::fputs( const char* s, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fputs" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fputs(s);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	size_t Cstdio::fread( void* ptr, size_t size, size_t nmemb, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::" );
		size_t Result = 0;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream(stream).fread(ptr, size, nmemb);
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	size_t Cstdio::fread_s( void* ptr, size_t DstSize, size_t ElementSize, size_t Count, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fread_s" );
		size_t Result = 0;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream(stream).fread_s(ptr, DstSize, ElementSize, Count);
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::freopen( const char* filename, const char* mode, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::freopen" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream(stream).freopen(filename, mode)->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	errno_t Cstdio::freopen_s( FILE** ppFile, const char* szFilename, const char* szMode, FILE* pOldFile )
	{
		_WINQ_FCONTEXT( "Cstdio::freopen_s" );
		errno_t Result = 0;
		__QOR_PROTECT
		{
			*ppFile = nsPosum::CStream(pOldFile).freopen(szFilename, szMode)->GetFILE();
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fscanf( FILE* stream, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::fscanf" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).vfscanf(format, vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fscanf_s( FILE* stream, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::fscanf_s" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).vfscanf(format, vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fseek( FILE* stream, long int offset, int whence )
	{
		_WINQ_FCONTEXT( "Cstdio::fseek" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fseek(offset, whence);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fseeko( FILE* stream , off_t offset , int whence )
	{
		_WINQ_FCONTEXT( "Cstdio::fseeko" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fseeko(offset, whence);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::fsetpos( FILE* stream, const fpos_t* pos )
	{
		_WINQ_FCONTEXT( "Cstdio::fsetpos" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).fsetpos(pos);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	long int Cstdio::ftell( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::ftell" );
		long int liResult = -1;
		__QOR_PROTECT
		{
			liResult = nsPosum::CStream(stream).ftell();
		}__QOR_ENDPROTECT
		return liResult;
	}

	//--------------------------------------------------------------------------------
	off_t Cstdio::ftello( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::ftello" );
		off_t Result = -1;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream(stream).ftello();
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::ftrylockfile( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::ftrylockfile" );
		int iResult = -1;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).ftrylockfile();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	void Cstdio::funlockfile( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::funlockfile" );
		__QOR_PROTECT
		{
			nsPosum::CStream(stream).funlockfile();
		}__QOR_ENDPROTECT
	}

	//--------------------------------------------------------------------------------
	size_t Cstdio::fwrite( const void* ptr, size_t size, size_t nmemb, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::fwrite" );
		size_t Result = 0;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream(stream).fwrite(ptr, size, nmemb);
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::getc( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::getc" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).getc();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::getchar( void )
	{
		_WINQ_FCONTEXT( "Cstdio::getchar" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->getc();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::getc_unlocked( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::getc_unlocked" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).getc_unlocked();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::getchar_unlocked( void )
	{
		_WINQ_FCONTEXT( "Cstdio::getchar_unlocked" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->getc_unlocked();
		}__QOR_ENDPROTECT
		return iResult;
	}
	//--------------------------------------------------------------------------------
	ssize_t Cstdio::getdelim( char** lineptr, size_t* n, int delimiter, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::getdelim" );
		ssize_t Result = 0;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream(stream).getdelim(lineptr, n, delimiter);
		}__QOR_ENDPROTECT
		return Result;
	}
	//--------------------------------------------------------------------------------
	ssize_t Cstdio::getline( char** lineptr, size_t* n, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::getline" );
		ssize_t Result = 0;
		__QOR_PROTECT
		{
			Result = nsPosum::CStream(stream).getline(lineptr, n);
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	char* Cstdio::gets( char* s )
	{
		_WINQ_FCONTEXT( "Cstdio::gets" );
		char* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::_stdin()->fgets(s, 0);
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	char* Cstdio::gets_s( char* s, size_t _Size )
	{
		_WINQ_FCONTEXT( "Cstdio::gets_s" );
		char* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::_stdin()->fgets(s, _Size);
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::open_memstream( char** bufp, size_t* sizep )
	{
		_WINQ_FCONTEXT( "Cstdio::open_memstream" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::open_memstream( bufp, sizep )->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::pclose( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::pclose" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).pclose();
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	void Cstdio::perror( const char* s )
	{
		_WINQ_FCONTEXT( "Cstdio::perror" );

		__QOR_PROTECT
		{
			nsPosum::CStream::_stderr()->fprintf(s);
		}__QOR_ENDPROTECT
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::popen( const char* command, const char* mode )
	{
		_WINQ_FCONTEXT( "Cstdio::popen" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::popen(command, mode)->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::printf( const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::printf" );
		int iResult = 0;

		if( format == 0 )
		{
			errno = EINVAL;
			iResult = -1;
		}
		else
		{
			iResult = ::nsPosum::CStream::_stdout()->_vfprintf_l( format, nullptr, vargs );
		}
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::printf_s( const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::printf_s" );
		int iResult = 0;
		__QOR_PROTECT
		{

			if( format == 0 )
			{
				errno = EINVAL;
				iResult = -1;
			}
			else
			{
				iResult = ::nsPosum::CStream::_stdout()->_vfprintf_l(format, nullptr, vargs);
			}
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::putc( int c, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::putc" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).putc(c);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::putchar( int c )
	{
		_WINQ_FCONTEXT( "Cstdio::putchar" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->putc(c);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::putc_unlocked( int c, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::putc_unlocked" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).putc_unlocked(c);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::putchar_unlocked( int c )
	{
		_WINQ_FCONTEXT( "Cstdio::putchar_unlocked" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->putc_unlocked(c);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	//puts
	int Cstdio::puts( const char* s )
	{
		_WINQ_FCONTEXT( "Cstdio::puts" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->fputs(s);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::remove( const char* filename )
	{
		_WINQ_FCONTEXT( "Cstdio::remove" );
		int iResult = 0;
		__QOR_PROTECT
		{
			//TODO: nsPosum::CStream::remove(filename);
		}__QOR_ENDPROTECT
		return iResult;
	}

#ifndef OS_EXPORTS_STDIO_RENAME

	//--------------------------------------------------------------------------------
	int Cstdio::rename( const char* old, const char* pnew )
	{
		_WINQ_FCONTEXT( "Cstdio::rename" );
		int iResult = 0;
		__QOR_PROTECT
		{
		}__QOR_ENDPROTECT
		return iResult;
	}

#endif

	//--------------------------------------------------------------------------------
	int Cstdio::renameat( int ofd, const char* szOld, int newfd, const char* szNew )
	{
		_WINQ_FCONTEXT( "Cstdio::renameat" );
		int iResult = 0;
		__QOR_PROTECT
		{
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	void Cstdio::rewind( FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::rewind" );
		__QOR_PROTECT
		{
			nsPosum::CStream(stream).rewind();
		}__QOR_ENDPROTECT
	}

	//--------------------------------------------------------------------------------
	int Cstdio::scanf( const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::scanf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->vfscanf(format,vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::scanf_s( const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::scanf_s" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->vfscanf(format, vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	void Cstdio::setbuf( FILE* stream, char* buf )
	{
		_WINQ_FCONTEXT( "Cstdio::setbuf" );
		__QOR_PROTECT
		{
			nsPosum::CStream(stream).setbuf(buf);
		}__QOR_ENDPROTECT
	}

	//--------------------------------------------------------------------------------
	int Cstdio::setvbuf( FILE* stream, char* buf, int mode, size_t size )
	{
		_WINQ_FCONTEXT( "Cstdio::setvbuf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).setvbuf(buf, mode, size);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::snprintf( char* s, size_t n, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::snprintf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			//iResult = nsPosum::CStream
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::sprintf( char* s, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::sprintf" );
		nsWin32::CStringHelper StringHelper;
		return StringHelper.wvsprintfA( s, format, vargs );
	}

	//--------------------------------------------------------------------------------
	int Cstdio::sprintf_s( char* s, size_t SizeInBytes, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::sprintf_s" );
		int iResult = 0;
		__QOR_PROTECT
		{
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::sscanf( const char* s, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::sscanf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->vfscanf(format, vargs);//TODO: s ?
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::sscanf_s( const char* s, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::sscanf_s" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->vfscanf(format, vargs);//TODO: s ?
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	char* Cstdio::tempnam( const char*, const char* )
	{
		_WINQ_FCONTEXT( "Cstdio::tempnam" );
		char* pResult = 0;
		__QOR_PROTECT
		{
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	FILE* Cstdio::tmpfile( void )
	{
		_WINQ_FCONTEXT( "Cstdio::tmpfile" );
		FILE* pResult = 0;
		__QOR_PROTECT
		{
			pResult = nsPosum::CStream::tmpfile()->GetFILE();
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	errno_t Cstdio::tmpfile_s( FILE** ppFile )
	{
		_WINQ_FCONTEXT( "Cstdio::tmpfile_s" );
		errno_t Result = 0;
		__QOR_PROTECT
		{
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	char* Cstdio::tmpnam( char* s )
	{
		_WINQ_FCONTEXT( "Cstdio::tmpnam" );
		char* pResult = 0;
		__QOR_PROTECT
		{
		}__QOR_ENDPROTECT
		return pResult;
	}

	//--------------------------------------------------------------------------------
	errno_t Cstdio::tmpnam_s( char* s, size_t Size )
	{
		_WINQ_FCONTEXT( "Cstdio::tmpnam_s" );
		errno_t Result = 0;
		__QOR_PROTECT
		{
			//Result = nsPosum::CStream::tmpnam_s(s, Size);//TODO:
		}__QOR_ENDPROTECT
		return Result;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::ungetc( int c, FILE* stream )
	{
		_WINQ_FCONTEXT( "Cstdio::ungetc" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).ungetc(c);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vfprintf( FILE* stream, const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::vfprintf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).vfprintf(format,vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vfprintf_s( FILE* stream, const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vfprintf_s");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).vfprintf_s(format,arg);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vfscanf( FILE* stream, const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vfscanf");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream(stream).vfscanf(format,arg);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vprintf(const char* format, va_list vargs )
	{
		_WINQ_FCONTEXT( "Cstdio::vprintf" );
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->vfprintf(format, vargs);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vprintf_s( const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vprintf_s");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->vfprintf(format, arg);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vscanf( const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vscanf");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->vfscanf(format, arg);
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vsnprintf( char* s, size_t n, const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vsnprintf");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->vfprintf(format, arg);//TODO: s, n ?
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vsprintf( char* s, const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vsprintf");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->vfprintf(format, arg);//TODO: s ?
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vsprintf_s( char* s, size_t SizeInBytes, const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vsprintf_s");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdout()->vfprintf_s(format, arg);//TODO: s, SizeInBytes ?
		}__QOR_ENDPROTECT
		return iResult;
	}

	//--------------------------------------------------------------------------------
	int Cstdio::vsscanf( const char* s, const char* format, va_list arg )
	{
		_WINQ_FCONTEXT( "Cstdio::vsscanf");
		int iResult = 0;
		__QOR_PROTECT
		{
			iResult = nsPosum::CStream::_stdin()->vfscanf(format, arg);//TODO: s ?
		}__QOR_ENDPROTECT
		return iResult;
	}

}//nsWin32

#endif//(QOR_SYS_OS == QOR_SYS_MSW)
