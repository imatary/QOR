//MMCInterfaces.h

// Copyright Querysoft Limited 2013, 2015
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
// 
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#ifndef WINQL_COM_MMC_INTERFACES_H_3
#define WINQL_COM_MMC_INTERFACES_H_3

#ifdef	__QCMP_OPTIMIZEINCLUDE
#pragma	__QCMP_OPTIMIZEINCLUDE
#endif//__QCMP_OPTIMIZEINCLUDE

#include "WinQL/WinQL.h"
#include "WinQL/Definitions/Interfaces.h"
#include "WinQL/COM/MMC/MMCData.h"
#include "WinQL/COM/Variant.h"

//Common Object Model interface definitions for Microsoft Management Console

//--------------------------------------------------------------------------------
namespace nsWin32
{
	//--------------------------------------------------------------------------------
	template< typename _t >
	bool IsSpecialDataObject( _t& d )
	{
		return (((Cmp_long_ptr)( d ) >= SPECIAL_DOBJ_MIN ) && ( (Cmp_long_ptr)(d) <= SPECIAL_DOBJ_MAX ) );
	}

	//--------------------------------------------------------------------------------
	template< typename _t >
	bool IsSpecialCookie( _t& c )
	{
		return ( ( c >= SPECIAL_COOKIE_MIN) && ( c <= SPECIAL_COOKIE_MAX ) );
	}

	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("547C1354-024D-11d3-A707-00C04F8EF4CB")) IColumnData : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION SetColumnConfigData( SColumnSetID* pColID, MMC_COLUMN_SET_DATA* pColSetData ) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetColumnConfigData( SColumnSetID* pColID, MMC_COLUMN_SET_DATA** ppColSetData ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetColumnSortData( SColumnSetID* pColID, MMC_SORT_SET_DATA* pColSortData ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetColumnSortData( SColumnSetID* pColID, MMC_SORT_SET_DATA** ppColSortData ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IColumnData_IID = { 0x547C1354, 0x024D, 0x11d3, 0xA7, 0x07, 0x00, 0xC0, 0x4F, 0x8E, 0xF4, 0xCB };
	/*
	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("43136EB9-D36C-11CF-ADBC-00AA00A80033")) IToolbar : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION AddBitmap( int nImages, void* hbmp, int cxSize, int cySize, unsigned long crMask ) = 0;
        virtual long __QCMP_STDCALLCONVENTION AddButtons( int nButtons, LPMMCBUTTON lpButtons ) = 0;
        virtual long __QCMP_STDCALLCONVENTION InsertButton( int nIndex, LPMMCBUTTON lpButton ) = 0;
        virtual long __QCMP_STDCALLCONVENTION DeleteButton( int nIndex ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetButtonState( int idCommand, MMC_BUTTON_STATE nState, int* pState ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetButtonState( int idCommand, MMC_BUTTON_STATE nState, int bState ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IToolbar_IID = { 0x43136EB9, 0xD36C, 0x11CF, 0xAD, 0xBC, 0x00, 0xAA, 0x00, 0xA8, 0x00, 0x33 };
	*/
	/*
	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("43136EB8-D36C-11CF-ADBC-00AA00A80033")) IImageList : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCOVENTION ImageListSetIcon( Cmp_long_ptr* pIcon, long nLoc ) = 0;
        virtual long __QCMP_STDCALLCOVENTION ImageListSetStrip( Cmp_long_ptr* pBMapSm, Cmp_long_ptr* pBMapLg, long nStartLoc, unsigned long cMask ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IImageList_IID = { 0x43136EB8, 0xD36C, 0x11CF, 0xAD, 0xBC, 0x00, 0xAA, 0x00, 0xA8, 0x00, 0x33 };
	*/
	/*
	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("E49F7A60-74AF-11D0-A286-00C04FD8FE93")) IConsoleVerb : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION GetVerbState( MMC_CONSOLE_VERB eCmdID, MMC_BUTTON_STATE nState, int* pState ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetVerbState( MMC_CONSOLE_VERB eCmdID, MMC_BUTTON_STATE nState, int bState ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetDefaultVerb( MMC_CONSOLE_VERB eCmdID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetDefaultVerb( MMC_CONSOLE_VERB* peCmdID ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IConsoleVerb_IID = { 0xE49F7A60, 0x74AF, 0x11D0, 0xA2, 0x86, 0x00, 0xC0, 0x4F, 0xD8, 0xFE, 0x93 };
	*/
	/*
	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("43136EB1-D36C-11CF-ADBC-00AA00A80033")) IConsole : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION SetHeader( IHeaderCtrl* pHeader ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetToolbar( IToolbar* pToolbar ) = 0;
        virtual long __QCMP_STDCALLCONVENTION QueryResultView( IUnknown* pUnknown ) = 0;
        virtual long __QCMP_STDCALLCONVENTION QueryScopeImageList( IImageList* ppImageList ) = 0;
        virtual long __QCMP_STDCALLCONVENTION QueryResultImageList( IImageList* ppImageList ) = 0;
        virtual long __QCMP_STDCALLCONVENTION UpdateAllViews( IDataObject* lpDataObject, Cmp_long_ptr data, Cmp_long_ptr hint ) = 0;
        virtual long __QCMP_STDCALLCONVENTION MessageBox( const wchar_t* lpszText, const wchar_t* lpszTitle, unsigned int fuStyle, int* piRetval ) = 0;
        virtual long __QCMP_STDCALLCONVENTION QueryConsoleVerb( IConsoleVerb* ppConsoleVerb ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SelectScopeItem( Cmp_long_ptr hScopeItem ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetMainWindow( void** phwnd ) = 0;
        virtual long __QCMP_STDCALLCONVENTION NewWindow( Cmp_long_ptr hScopeItem, unsigned long lOptions ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IConsole_IID = { 0x43136EB1, 0xD36C, 0x11CF, 0xAD, 0xBC, 0x00, 0xAA, 0x00, 0xA8, 0x00, 0x33 };
	*/
	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("103D842A-AA63-11D1-A7E1-00C04FD8D565")) IConsole2 : public IConsole
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION Expand( Cmp_long_ptr hItem, int bExpand ) = 0;
        virtual long __QCMP_STDCALLCONVENTION IsTaskpadViewPreferred( void ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetStatusText( wchar_t* pszStatusText ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IConsole2_IID = { 0x103D842A, 0xAA63, 0x11D1, 0xA7, 0xE1, 0x00, 0xC0, 0x4F, 0xD8, 0xD5, 0x65 };

	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("BEDEB620-F24D-11cf-8AFC-00AA003CA9F6")) IConsoleNameSpace : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION InsertItem( SCOPEDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION DeleteItem( Cmp_long_ptr hItem, long fDeleteThis ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetItem( SCOPEDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetItem( SCOPEDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetChildItem( Cmp_long_ptr item, Cmp_long_ptr* pItemChild, Cmp_long_ptr* pCookie ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetNextItem( Cmp_long_ptr item, Cmp_long_ptr* pItemNext, Cmp_long_ptr* pCookie ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetParentItem( Cmp_long_ptr item, Cmp_long_ptr* pItemParent, Cmp_long_ptr* pCookie ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IConsoleNameSpace_IID = { 0xBEDEB620, 0xF24D, 0x11cf, 0x8A, 0xFC, 0x00, 0xAA, 0x00, 0x3C, 0xA9, 0xF6 };

	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("255F18CC-65DB-11D1-A7DC-00C04FD8D565")) IConsoleNameSpace2 : public IConsoleNameSpace
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION Expand( Cmp_long_ptr hItem ) = 0;
        virtual long __QCMP_STDCALLCONVENTION AddExtension( Cmp_long_ptr hItem, GUID* lpClsid ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IConsoleNameSpace2_IID = { 0x255F18CC, 0x65DB, 0x11D1, 0xA7, 0xDC, 0x00, 0xC0, 0x4F, 0xD8, 0xD5, 0x65 };

	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("43136EB7-D36C-11CF-ADBC-00AA00A80033")) IContextMenuCallback : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION AddItem( CONTEXTMENUITEM* pItem ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IContextMenuCallback_IID = { 0x43136EB7, 0xD36C, 0x11CF, 0xAD, 0xBC, 0x00, 0xAA, 0x00, 0xA8, 0x00, 0x33 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("E178BC0E-2ED0-4b5e-8097-42C9087E8B33")) IContextMenuCallback2 : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION AddItem( CONTEXTMENUITEM2* pItem ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IContextMenuCallback2_IID = { 0xE178BC0E, 0x2ED0, 0x4b5e, 0x80, 0x97, 0x42, 0xC9, 0x08, 0x7E, 0x8B, 0x33 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("43136EB6-D36C-11CF-ADBC-00AA00A80033")) IContextMenuProvider : public IContextMenuCallback
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION EmptyMenuList( void ) = 0;
        virtual long __QCMP_STDCALLCONVENTION AddPrimaryExtensionItems( IUnknown* piExtension, IDataObject* piDataObject ) = 0;
        virtual long __QCMP_STDCALLCONVENTION AddThirdPartyExtensionItems( IDataObject* piDataObject ) = 0;
        virtual long __QCMP_STDCALLCONVENTION ShowContextMenu( void* hwndParent, long xPos, long yPos, long* plSelected ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IContextMenuProvider_IID = { 0x43136EB6, 0xD36C, 0x11CF, 0xAD, 0xBC, 0x00, 0xAA, 0x00, 0xA8, 0x00, 0x33 };

	struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("49506520-6F40-11D0-A98B-00C04FD8D565") ) IExtendControlbar;

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("69FB811E-6C1C-11D0-A2CB-00C04FD909DD")) IControlbar : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION Create( MMC_CONTROL_TYPE nType, IExtendControlbar pExtendControlbar, IUnknown* ppUnknown ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Attach( MMC_CONTROL_TYPE nType, IUnknown* lpUnknown ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Detach( IUnknown* lpUnknown ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IControlbar_IID = { 0x69FB811E, 0x6C1C, 0x11D0, 0xA2, 0xCB, 0x00, 0xC0, 0x4F, 0xD9, 0x09, 0xDD };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("49506520-6F40-11D0-A98B-00C04FD8D565") ) IExtendControlbar : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION SetControlbar( IControlbar* pControlbar) = 0;
        virtual long __QCMP_STDCALLCONVENTION ControlbarNotify( MMC_NOTIFY_TYPE event, Cmp_long_ptr arg, Cmp_long_ptr param ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IExtendControlbar_IID = { 0x49506520, 0x6F40, 0x11D0, 0xA9, 0x8B, 0x00, 0xC0, 0x4F, 0xD8, 0xD5, 0x65 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("cc593830-b926-11d1-8063-0000f875a9ce")) IDisplayHelp : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION ShowTopic( wchar_t* pszHelpTopic ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IDisplayHelp_IID = { 0xcc593830, 0xb926, 0x11d1, 0x80, 0x63, 0x00, 0x00, 0xf8, 0x75, 0xa9, 0xce };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("951ED750-D080-11d0-B197-000000000000")) IMenuButton : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION AddButton( int idCommand, wchar_t* lpButtonText, wchar_t* lpTooltipText ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetButton( int idCommand, wchar_t* lpButtonText, wchar_t* lpTooltipText ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetButtonState( int idCommand, MMC_BUTTON_STATE nState, int bState ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IMenuButton_IID = { 0x951ED750, 0xD080, 0x11d0, 0xB1, 0x97, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("80F94174-FCCC-11d2-B991-00C04F8ECD78")) IMessageView : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION SetTitleText( wchar_t* pszTitleText ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetBodyText( const wchar_t* pszBodyText ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetIcon( IconIdentifier id ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Clear( void ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IMessageView_IID = { 0x80F94174, 0xFCCC, 0x11d2, 0xB9, 0x91, 0x00, 0xC0, 0x4F, 0x8E, 0xCD, 0x78 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("85DE64DD-EF21-11cf-A285-00C04FD8DBE6")) IPropertySheetCallback : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION AddPage( void* hPage) = 0;
        virtual long __QCMP_STDCALLCONVENTION RemovePage( void* hPage) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IPropertySheetCallback_IID = { 0x85DE64DD, 0xEF21, 0x11cf, 0xA2, 0x85, 0x00, 0xC0, 0x4F, 0xD8, 0xDB, 0xE6 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("85DE64DE-EF21-11cf-A285-00C04FD8DBE6")) IPropertySheetProvider : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION CreatePropertySheet( const wchar_t* title, unsigned char type, Cmp_long_ptr cookie, IDataObject* pIDataObjectm, unsigned long dwOptions) = 0;
        virtual long __QCMP_STDCALLCONVENTION FindPropertySheet( Cmp_long_ptr hItem, IComponent* lpComponent, IDataObject* lpDataObject ) = 0;
        virtual long __QCMP_STDCALLCONVENTION AddPrimaryPages( IUnknown* lpUnknown, int bCreateHandle, void* hNotifyWindow, int bScopePane ) = 0;
        virtual long __QCMP_STDCALLCONVENTION AddExtensionPages( void ) = 0;        
        virtual long __QCMP_STDCALLCONVENTION Show( Cmp_long_ptr window, int page ) = 0;    
    };

	extern "C" const GUID __declspec( selectany ) IPropertySheetProvider_IID = { 0x85DE64DE, 0xEF21, 0x11cf, 0xA2, 0x85, 0x00, 0xC0, 0x4F, 0xD8, 0xDB, 0xE6 };

	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("72782D7A-A4A0-11d1-AF0F-00C04FB6DD2C")) IRequiredExtensions : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION EnableAllExtensions( void ) = 0;        
        virtual long __QCMP_STDCALLCONVENTION GetFirstExtension( GUID* pExtCLSID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetNextExtension( GUID* pExtCLSID ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IRequiredExtensions_IID = { 0x72782D7A, 0xA4A0, 0x11d1, 0xAF, 0x0F, 0x00, 0xC0, 0x4F, 0xB6, 0xDD, 0x2C };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("31DA5FA0-E0EB-11cf-9F21-00AA003CA9F6")) IResultData : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION InsertItem( RESULTDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION DeleteItem( Cmp_long_ptr itemID, int nCol ) = 0;
        virtual long __QCMP_STDCALLCONVENTION FindItemByLParam( Cmp_long_ptr lParam, Cmp_long_ptr* pItemID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION DeleteAllRsltItems( void ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetItem( RESULTDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetItem( RESULTDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetNextItem( RESULTDATAITEM* item ) = 0;
        virtual long __QCMP_STDCALLCONVENTION ModifyItemState( int nIndex, Cmp_long_ptr itemID, unsigned int uAdd, unsigned int uRemove ) = 0;
        virtual long __QCMP_STDCALLCONVENTION ModifyViewStyle( MMC_RESULT_VIEW_STYLE add, MMC_RESULT_VIEW_STYLE remove ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetViewMode( long lViewMode ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetViewMode( long* lViewMode ) = 0;        
        virtual long __QCMP_STDCALLCONVENTION UpdateItem( Cmp_long_ptr itemID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Sort( int nColumn, unsigned long dwSortOptions, Cmp_long_ptr lUserParam ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetDescBarText( wchar_t* DescText ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SetItemCount( int nItemCount, unsigned long dwOptions ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IResultData_IID = { 0x31DA5FA0, 0xE0EB, 0x11cf, 0x9F, 0x21, 0x00, 0xAA, 0x00, 0x3C, 0xA9, 0xF6 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("DE40B7A4-0F65-11d2-8E25-00C04F8ECD78")) IStringTable : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION AddString( const wchar_t* pszAdd, unsigned long* pStringID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetString( unsigned long StringID, unsigned long cchBuffer, wchar_t* lpBuffer, unsigned long* pcchOut ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetStringLength( unsigned long StringID, unsigned long* pcchString) = 0;
        virtual long __QCMP_STDCALLCONVENTION DeleteString( unsigned long StringID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION DeleteAllStrings( void ) = 0;
        virtual long __QCMP_STDCALLCONVENTION FindString( const wchar_t* pszFind, unsigned long* pStringID ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Enumerate( IEnumString** ppEnum ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IStringTable_IID = { 0xDE40B7A4, 0x0F65, 0x11d2, 0x8E, 0x25, 0x00, 0xC0, 0x4F, 0x8E, 0xCD, 0x78 };






    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("338698b1-5a02-11d1-9fec-00600832db4a")) IEnumTASK : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION Next( unsigned long celt, MMC_TASK* rgelt, unsigned long* pceltFetched ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Skip( unsigned long celt ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Reset( void ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Clone( IEnumTASK** ppenum ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IEnumTASK_IID = { 0x338698b1, 0x5a02, 0x11d1, 0x9f, 0xec, 0x00, 0x60, 0x08, 0x32, 0xdb, 0x4a };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("4F3B7A4F-CFAC-11CF-B8E3-00C04FD8D5B0")) IExtendContextMenu : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION AddMenuItems( IDataObject* piDataObject, IContextMenuCallback* piCallback, long* pInsertionAllowed ) = 0;
        virtual long __QCMP_STDCALLCONVENTION Command( long lCommandID, IDataObject* piDataObject ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IExtendContextMenu_IID = { 0x4F3B7A4F, 0xCFAC, 0x11CF, 0xB8, 0xE3, 0x00, 0xC0, 0x4F, 0xD8, 0xD5, 0xB0 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("85DE64DC-EF21-11cf-A285-00C04FD8DBE6")) IExtendPropertySheet : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION CreatePropertyPages( IPropertySheetCallback* lpProvider, Cmp_long_ptr handle, IDataObject* lpIDataObject ) = 0;
        virtual long __QCMP_STDCALLCONVENTION QueryPagesFor( IDataObject* lpDataObject ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IExtendPropertySheet_IID = { 0x85DE64DC, 0xEF21, 0x11cf, 0xA2, 0x85, 0x00, 0xC0, 0x4F, 0xD8, 0xDB, 0xE6 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("B7A87232-4A51-11D1-A7EA-00C04FD909DD")) IExtendPropertySheet2 : public IExtendPropertySheet
    {
    public:
		
		virtual long __QCMP_STDCALLCONVENTION GetWatermarks( IDataObject* lpIDataObject, void** lphWatermark, void** lphHeader, void** lphPalette, int* bStretch) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) IExtendPropertySheet2_IID = { 0xB7A87232, 0x4A51, 0x11D1, 0xA7, 0xEA, 0x00, 0xC0, 0x4F, 0xD9, 0x09, 0xDD };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("8dee6511-554d-11d1-9fea-00600832db4a")) IExtendTaskpad : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION TaskNotify( IDataObject *pdo, VARIANT *arg, VARIANT *param ) = 0;
        virtual long __QCMP_STDCALLCONVENTION EnumTasks( IDataObject *pdo, wchar_t* szTaskGroup, IEnumTASK** ppEnumTASK ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetTitle( wchar_t* pszGroup, wchar_t** pszTitle) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetDescriptiveText( wchar_t* pszGroup, wchar_t** pszDescriptiveText ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetBackground( wchar_t* pszGroup, MMC_TASK_DISPLAY_OBJECT* pTDO ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetListPadInfo( wchar_t* pszGroup, MMC_LISTPAD_INFO* lpListPadInfo ) = 0;
    };
	
	extern "C" const GUID __declspec( selectany ) IExtendTaskpad_IID = { 0x8dee6511, 0x554d, 0x11d1, 0x9f, 0xea, 0x00, 0x60, 0x08, 0x32, 0xdb, 0x4a };

	//--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("E8315A52-7A1A-11D0-A2D2-00C04FD909DD")) IResultDataCompare : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION Compare( Cmp_long_ptr lUserParam, Cmp_long_ptr cookieA, Cmp_long_ptr cookieB, int* pnResult) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IResultDataCompare_IID = { 0xE8315A52, 0x7A1A, 0x11D0, 0xA2, 0xD2, 0x00, 0xC0, 0x4F, 0xD9, 0x09, 0xDD };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("96933476-0251-11d3-AEB0-00C04F8ECD78")) IResultDataCompareEx : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION Compare( RDCOMPARE* prdc, int* pnResult ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IResultDataCompareEx_IID = { 0x96933476, 0x0251, 0x11d3, 0xAE, 0xB0, 0x00, 0xC0, 0x4F, 0x8E, 0xCD, 0x78 };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("9CB396D8-EA83-11d0-AEF1-00C04FB6DD2C")) IResultOwnerData : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION FindItem( RESULTFINDINFO* pFindInfo, int* pnFoundIndex ) = 0;
        virtual long __QCMP_STDCALLCONVENTION CacheHint( int nStartIndex, int nEndIndex ) = 0;
        virtual long __QCMP_STDCALLCONVENTION SortItems( int nColumn, unsigned long dwSortOptions, Cmp_long_ptr lUserParam ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) IResultOwnerData_IID = { 0x9CB396D8, 0xEA83, 0x11d0, 0xAE, 0xF1, 0x00, 0xC0, 0x4F, 0xB6, 0xDD, 0x2C };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("1245208C-A151-11D0-A7D7-00C04FD909DD")) ISnapinAbout : public IUnknown
    {
    public:

        virtual long __QCMP_STDCALLCONVENTION GetSnapinDescription( wchar_t** lpDescription ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetProvider( wchar_t** lpName ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetSnapinVersion( wchar_t** lpVersion ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetSnapinImage( void** hAppIcon ) = 0;
        virtual long __QCMP_STDCALLCONVENTION GetStaticFolderImage( void** hSmallImage, void** hSmallImageOpen, void** hLargeImage, unsigned long* cMask ) = 0;        
    };

	extern "C" const GUID __declspec( selectany ) ISnapinAbout_IID = { 0x1245208C, 0xA151, 0x11D0, 0xA7, 0xD7, 0x00, 0xC0, 0x4F, 0xD9, 0x09, 0xDD };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("A6B15ACE-DF59-11D0-A7DD-00C04FD909DD")) ISnapinHelp : public IUnknown
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION GetHelpTopic( wchar_t** lpCompiledHelpFile ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) ISnapinHelp_IID = { 0xA6B15ACE, 0xDF59, 0x11D0, 0xA7, 0xDD, 0x00, 0xC0, 0x4F, 0xD9, 0x09, 0xDD };

    //--------------------------------------------------------------------------------
    struct __QOR_INTERFACE( __WINQL ) __declspec(uuid("4861A010-20F9-11d2-A510-00C04FB6DD2C")) ISnapinHelp2 : public ISnapinHelp
    {
    public:
        virtual long __QCMP_STDCALLCONVENTION GetLinkedTopics( wchar_t** lpCompiledHelpFiles ) = 0;
    };

	extern "C" const GUID __declspec( selectany ) ISnapinHelp2_IID = { 0x4861A010, 0x20F9, 0x11d2, 0xA5, 0x10, 0x00, 0xC0, 0x4F, 0xB6, 0xDD, 0x2C };

}//nsWin32

#endif//WINQL_COM_MMC_INTERFACES_H_3

